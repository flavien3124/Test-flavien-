<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Test ‚Äî Question par question</title>
  <style>
    :root{--bg:#0b0f17;--card:#121a2a;--txt:#e9eefc;--mut:#a9b4d0;--a:#ffcc33;--b:#ff4d6d;}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--txt);}
    .wrap{max-width:820px;margin:0 auto;padding:22px 14px 60px;}
    .card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.10);border-radius:18px;padding:18px 16px;box-shadow:0 20px 60px rgba(0,0,0,.35);}
    h1{margin:0 0 8px;font-size:22px;}
    p{margin:8px 0;color:var(--mut);line-height:1.35}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .q{font-size:22px;font-weight:800;margin:10px 0 14px;}
    .btn{border:none;border-radius:14px;padding:12px 14px;font-weight:900;cursor:pointer}
    .yes{background:linear-gradient(90deg,var(--a),#ffe07a);color:#1b1403;}
    .no{background:linear-gradient(90deg,var(--b),#ff93a6);color:#24030a;}
    .ghost{background:transparent;border:1px solid rgba(255,255,255,.14);color:var(--txt);font-weight:800;}
    .choices{display:flex;gap:10px;flex-wrap:wrap}
    .choice{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:var(--txt);}
    .progress{height:10px;background:rgba(255,255,255,.10);border-radius:999px;overflow:hidden;margin-top:14px}
    .bar{height:100%;width:0%;background:linear-gradient(90deg,var(--a),var(--b));}
    .small{font-size:13px;color:var(--mut);margin-top:10px}
    .hidden{display:none!important}
    table{width:100%;border-collapse:collapse;margin:16px 0;font-size:14px;}
    th,td{padding:8px;text-align:left;border-top:1px solid rgba(255,255,255,0.1);}
    th{background:rgba(255,255,255,0.08);}
    small{font-size:0.8em;opacity:0.8;}
  </style>
</head>

<body>
<div class="wrap">
  <div class="card" id="screenIntro">
    <h1>Test (contenu adulte)</h1>
    <p>‚ö†Ô∏è 18+ ‚Ä¢ questions sexuelles / sensibles. Rien n‚Äôest envoy√© : tout reste sur ton t√©l√©phone.</p>
    <div class="row">
      <button class="btn yes" id="startBtn">Commencer</button>
    </div>
  </div>

  <div class="card hidden" id="screenQuiz">
    <div class="small" id="counter"></div>
    <div class="q" id="qText">‚Äî</div>

    <div id="yesnoBlock" class="row hidden">
      <button class="btn yes" id="btnYes">Oui</button>
      <button class="btn no" id="btnNo">Non</button>
    </div>

    <div id="choiceBlock" class="choices hidden"></div>

    <div class="progress"><div class="bar" id="bar"></div></div>

    <div class="row" style="margin-top:14px">
      <button class="btn ghost" id="btnBack">Retour</button>
      <button class="btn ghost" id="btnRestart">Recommencer</button>
    </div>
  </div>

  <div class="card hidden" id="screenResult">
    <h1>R√©sultat</h1>
    <div class="q" id="resultMain">‚Äî</div>
    <div id="resultText">‚Äî</div>
    <div class="row">
      <button class="btn yes" id="btnReplay">Rejouer</button>
      <button class="btn ghost" id="btnCopy">Copier r√©sultat</button>
    </div>
  </div>
</div>

<script>
const QUESTIONS = [
  { id:"q1", type:"yesno", text:"As-tu d√©j√† touch√© volontairement les parties intimes d'un camarade ?", next:"q2" },
  
  { id:"q2", type:"yesno", text:"T'es-tu d√©j√† exhib√© dans un bar ?", next:"q3" },
  
  { id:"q3", type:"yesno", text:"As-tu d√©j√† √©jacul√© dans une bouteille pour ne pas bouger de ton lit ?", onYes:"q3a", onNo:"q4" },
  { id:"q3a", type:"choice", text:"Combien de fois ?", options:["1","2","3","4","5‚Äì10","10+"], next:"q4" },
  
  { id:"q4", type:"yesno", text:"As-tu d√©j√† embrass√© une inconnue en bo√Æte ?", onYes:"q4a", onNo:"q5" },
  { id:"q4a", type:"choice", text:"Combien de fois ?", options:["1","2","3","4","5‚Äì10","10+"], next:"q5" },
  
  { id:"q5", type:"yesno", text:"As-tu d√©j√† tromp√© ?", onYes:"q5a", onNo:"q6" },
  { id:"q5a", type:"choice", text:"Combien de fois ?", options:["1","2","3","4","5‚Äì10","10+"], next:"q6" },
  
  { id:"q6", type:"yesno", text:"As-tu d√©j√† √©t√© accus√© de viol ?", next:"q7" },
  
  { id:"q7", type:"yesno", text:"As-tu d√©j√† touch√© √† une drogue ?", onYes:"q7a", onNo:"q8" },
  { id:"q7a", type:"choice", text:"Combien de drogues diff√©rentes ?", options:["1","2","3","4","5‚Äì10","10+"], next:"q8" },
  
  { id:"q8", type:"yesno", text:"As-tu d√©j√† eu des rapports homosexuels ?", next:"q9" },
  
  { id:"q9", type:"yesno", text:"As-tu d√©j√† eu des relations avec ton cousin / ta cousine ?", onYes:"q9a", onNo:"q10" },
  { id:"q9a", type:"choice", text:"Avec les deux ?", options:["Oui","Non"], next:"q10" },
  
  { id:"q10", type:"yesno", text:"T'es-tu d√©j√† fait violer ?", next:"q11" },
  
  { id:"q11", type:"yesno", text:"As-tu d√©j√† urin√© sur ta m√®re ?", next:"q12" },
  
  { id:"q12", type:"yesno", text:"T'es-tu d√©j√† fait frapper par ton p√®re ?", onYes:"q12a", onNo:"q13" },
  { id:"q12a", type:"choice", text:"Les gendarmes ont-ils d√ª intervenir ?", options:["Oui","Non"], next:"q13" },
  
  { id:"q13", type:"yesno", text:"Ton psy t'a d√©j√† dit une phrase du genre : ¬´ vous savez, il y a des gens qui ont de vrais probl√®mes dans la vie ¬ª ?", next:"q14" },
  
  { id:"q14", type:"yesno", text:"As-tu d√©j√† fait ou re√ßu une fellation avec une personne du m√™me sexe ?", onYes:"q14a", onNo:"q15" },
  { id:"q14a", type:"choice", text:"√Ä quel √¢ge la premi√®re fois ?", options:["18‚Äì20","21‚Äì25","26‚Äì30","31‚Äì40","40+"], next:"q15" },
  
  { id:"q15", type:"yesno", text:"As-tu d√©j√† eu un rapport dans un parc pour enfants ?", next:"q16" },
  
  { id:"q16", type:"yesno", text:"As-tu d√©j√† eu un rapport dans une grande roue ?", next:"q17" },
  
  { id:"q17", type:"yesno", text:"As-tu d√©j√† pratiqu√© l‚Äôanal ?", next:"q18" },
  
  { id:"q18", type:"yesno", text:"As-tu d√©j√† pratiqu√© le BDSM ?", onYes:"q18a", onNo:"q19" },
  { id:"q18a", type:"choice", text:"Qui √©tait attach√© ?", options:["Toi","Partenaire","Les deux","Personne"], next:"q18b" },
  { id:"q18b", type:"choice", text:"Qui a √©t√© frapp√© ?", options:["Toi","Partenaire","Les deux","Personne"], nextMap:{ "Personne":"q18d", "Toi":"q18c", "Partenaire":"q18c", "Les deux":"q18c" } },
  { id:"q18c", type:"choice", text:"Jusqu‚Äô√† laisser des bleus ?", options:["oui","non"], next:"q18d" },
  { id:"q18d", type:"choice", text:"Qui avait les yeux band√©s ?", options:["Toi","Partenaire","Les deux","Personne"], next:"q18e" },
  { id:"q18e", type:"choice", text:"Utilisation d‚Äôun fouet ?", options:["oui","non"], next:"q18f" },
  { id:"q18f", type:"choice", text:"Gifl√© pendant un rapport ?", options:["Toi","Partenaire","Les deux","Personne"], next:"q19" },
  
  { id:"q19", type:"yesno", text:"As-tu d√©j√† fait ou re√ßu des griffures pendant un √©bat ?", onYes:"q19a", onNo:"q20" },
  { id:"q19a", type:"choice", text:"Qui a fait les griffures ?", options:["Toi","Partenaire","Les deux"], next:"q20" },
  
  { id:"q20", type:"yesno", text:"T‚Äôes-tu d√©j√† masturb√© alors qu‚Äôune autre personne non concern√© √©tait pr√©sent dans la pi√®ce ?", onYes:"q20a", onNo:"q21" },
  { id:"q20a", type:"choice", text:"Quel type de tiers √©tait pr√©sent ?", options:["Personne adulte","Enfant","membre de la famille"], next:"q20b" },
  { id:"q20b", type:"choice", text:"Es-tu all√© jusqu‚Äô√† l‚Äôorgasme ?", options:["Oui","Non"], nextMap:{ "Oui":"q20c", "Non":"q21" } },
  { id:"q20c", type:"choice", text:"A t'il re√ßu du sperme/mouille sur lui?", options:["Oui","Non"], nextMap:{ "Oui":"q20d", "Non":"q21" } },
  { id:"q20d", type:"choice", text:"√âtait-ce volontaire ?", options:["Oui","Non"], next:"q21" },
  
  { id:"q21", type:"yesno", text:"Un membre de ta famille a-t-il d√©j√† d√ª g√©rer les cons√©quences d‚Äôun acte intime te concernant ?", next:"q22"},
  
  { id:"q22", type:"yesno", text:"As-tu d√©j√† appris √† quelqu‚Äôun comment se masturber ?", onYes:"q22a", onNo:"q23" },
  { id:"q22a", type:"choice", text:"√Ä combien de personnes ?", options:["1","2","3","4","5‚Äì10","10+"], next:"q22b" },
  { id:"q22b", type:"choice", text:"As-tu d√©j√† appris cela √† ton meilleur ami ?", options:["Oui","Non"], next:"q23" },
  
  { id:"q23", type:"yesno", text:"As-tu d√©j√† r√©pondu √† un appel t√©l√©phonique en plein √©bat ?", next:"q24" },
  
  { id:"q24", type:"yesno", text:"As-tu d√©j√† urin√© dans le capot d‚Äôune voiture ?", next:"q25" },
  
  { id:"q25", type:"yesno", text:"As-tu d√©j√† fait perdre la virginit√© √† quelqu‚Äôun ?", onYes:"q25a", onNo:"q26" },
  { id:"q25a", type:"choice", text:"√Ä combien de personnes ?", options:["1","2","3","4","5‚Äì10","10+"], next:"q26" },
  
  { id:"q26", type:"yesno", text:"As-tu d√©j√† pratiqu√© le ‚Äúchocopouce‚Äù (doigt ins√©r√© dans l‚Äôanus) ?", onYes:"q26a", onNo:"q27" },
  { id:"q26a", type:"choice", text:"Qui l‚Äôa re√ßu ?", options:["Toi","Partenaire","Les deux"], next:"q27" },
  
  { id:"q27", type:"yesno", text:"As-tu d√©j√† utilis√© un sextoy ?", onYes:"q27a", onNo:"q28" },
  { id:"q27a", type:"choice", text:"√âtait-ce pendant un rapport sexuel ?", options:["Oui","Non"], nextMap:{ "Oui":"q27b", "Non":"q28" } },
  { id:"q27b", type:"choice", text:"Sur qui ?", options:["Toi","Partenaire","Les deux"], next:"q28" },
  
  { id:"q28", type:"yesno", text:"T‚Äôes-tu d√©j√† masturb√© alors qu‚Äôun animal √©tait dans la piece ?", onYes:"q28a", onNo:"q29" },
  { id:"q28a", type:"choice", text:"Quel type d'animal √©tait pr√©sent ?", options:["chien","chat","lapin","hamster","autre"], next:"q28b" },
  { id:"q28b", type:"choice", text:"Es-tu all√© jusqu‚Äô√† l‚Äôorgasme ?", options:["Oui","Non"], nextMap:{ "Oui":"q28c", "Non":"q29" } },
  { id:"q28c", type:"choice", text:"A t'il re√ßu du sperme/mouille sur lui?", options:["Oui","Non"], nextMap:{ "Oui":"q28d", "Non":"q29" } },
  { id:"q28d", type:"choice", text:"√âtait-ce volontaire ?", options:["Oui","Non"], next:"q29" },
  
  { id:"q29", type:"yesno", text:"A tu dej√† penser √† avoir un rapport sexuel avec un animal ?", onYes:"q29a", onNo:"q30" },
  { id:"q29a", type:"choice", text:"Quel type d'animal ?", options:["chien","chat","lapin","hamster","cheval","animaux de ferme","autre"], next:"q30" },
  
  { id:"q30", type:"yesno", text:"As-tu d√©j√† eu un rapport sexuel en pr√©sence d‚Äôune personne non concern√©e dans la pi√®ce ?", next:"q31" },
  
  { id:"q31", type:"yesno", text:"T‚Äôes-tu d√©j√† dit : ¬´ si je retombe sur des fesses dans les 3 prochains scrolls, je vais sur Pornhub ¬ª ?", next:"q32" },
  
  { id:"q32", type:"yesno", text:"T‚Äôes-tu d√©j√† questionn√© sur l‚Äôorientation sexuelle ou les pratiques de personnages fictifs ?", next:"q33" },
  
  { id:"q33", type:"yesno", text:"Connais-tu la r√®gle 34 ?", onYes:"q33a", onNo:"q34" },
  { id:"q33a", type:"choice", text:"L‚Äôas-tu d√©j√† utilis√©e pour ton plaisir personnel ?", options:["Oui","Non"], next:"q34" },
  
  { id:"q34", type:"yesno", text:"Consommes-tu des hentais ?", next:"q34a" },
  { id:"q34a", type:"choice", text:"As-tu d√©j√† consomm√© du contenu hentai avec des personnages clairement mineurs (loli/shota) ?", options:["Oui","Non"], nextMap:{ "Oui":"q34b", "Non":"q35" } },
  { id:"q34b", type:"choice", text:"√Ä quelle fr√©quence ?", options:["Une fois par curiosit√©", "R√©guli√®rement", "C'est mon genre principal"], next:"q35" },
  
  { id:"q35", type:"yesno", text:"Te masturbes-tu quotidiennement ?", onYes:"q35a", onNo:"q36" },
  { id:"q35a", type:"choice", text:"Combien de fois par semaine ?", options:["1‚Äì2","3‚Äì4","5‚Äì6","7‚Äì8","9‚Äì10","10+"], next:"q36" },
  
  { id:"q36", type:"yesno", text:"Consid√®res-tu avoir √©t√© ou √™tre addict √† la masturbation ?", onYes:"q36a", onNo:"q37" },
  { id:"q36a", type:"choice", text:"Nombre maximum de masturbations en une journ√©e ?", options:["1‚Äì3","4‚Äì7","8‚Äì12","13‚Äì20","20+"], next:"q37" },
  
  { id:"q37", type:"yesno", text:"As-tu d√©j√† particip√© √† une golden shower ?", next:"q38" },
  
  { id:"q38", type:"yesno", text:"As-tu d√©j√† pris une douche avec une personne du sexe oppos√© (hors famille) ?", next:"q39" },
  
  { id:"q39", type:"yesno", text:"As-tu d√©j√† utilis√© un doudou pour te masturber ?", onYes:"q39a", onNo:"q40" },
  { id:"q39a", type:"choice", text:"As-tu d√©j√† fait un trou dans le doudou ?", options:["Oui","Non"], next:"q39b" },
  { id:"q39b", type:"choice", text:"As-tu d√©j√† √©jacul√© sur ou dans le doudou ?", options:["Oui","Non"], next:"q40" },
  
  { id:"q40", type:"yesno", text:"As-tu d√©j√† fantasm√© sur un membre de ta famille proche (fr√®re/s≈ìur, parent, etc.) ?", onYes:"q40a", onNo:"q41" },
  { id:"q40a", type:"choice", text:"As-tu d√©j√† agi dessus (m√™me un simple contact ambigu) ?", options:["Oui", "Non", "Juste un baiser de famille qui a d√©rap√©"], next:"q41" },
  
  { id:"q41", type:"yesno", text:"As-tu d√©j√† vu un parent / beau-parent nu sans le vouloir (mais tu as regard√© un peu trop longtemps) ?", next:"q42" },
  
  { id:"q42", type:"yesno", text:"As-tu d√©j√† utilis√© un sous-v√™tement d‚Äôun membre de ta famille pour te masturber ?", onYes:"q42a", onNo:"q43" },
  { id:"q42a", type:"choice", text:"C‚Äô√©tait propre ou sale ?", options:["Propre", "Sale / port√©", "Tr√®s port√© / odeur forte"], next:"q43" },
  
  { id:"q43", type:"yesno", text:"As-tu d√©j√† laiss√© un animal te l√©cher les parties intimes (m√™me 'par accident') ?", next:"q46" },
  
  
  
  
  
  
  
  
  { id:"q46", type:"yesno", text:"T‚Äôa-t-on d√©j√† demand√© de gifler / frapper au visage ton partenaire jusqu‚Äô√† ce qu‚Äôil/elle pleure ?", onYes:"q46a", onNo:"q47" },
  
  { id:"q46a", type:"choice", text:"As-tu accept√© et l‚Äôas-tu fait ?", options:["Oui et j‚Äôai continu√©", "Oui mais j‚Äôai arr√™t√© avant", "Non, j‚Äôai refus√©"], next:"q47" },
  
  { id:"q47", type:"yesno", text:"As-tu d√©j√† utilis√© des pinces √† t√©tons / pinces √† linge sur tes parties g√©nitales ?", next:"q48" },
  
  { id:"q48", type:"yesno", text:"T‚Äôes-tu d√©j√† masturb√©¬∑e dans un magasin (cabine d‚Äôessayage, rayon discret) ?", next:"q49" },
  
  { id:"q49", type:"yesno", text:"As-tu d√©j√† envoy√© une photo / vid√©o de toi en train de jouir √† quelqu‚Äôun qui ne te conna√Æt pas vraiment ?", onYes:"q49a", onNo:"q50" },
  
  { id:"q49a", type:"choice", text:"C‚Äô√©tait sur un r√©seau anonyme (Omegle, Discord, etc.) ?", options:["Oui", "Non"], next:"q50" },
  
  { id:"q50", type:"yesno", text:"As-tu d√©j√† fait semblant d‚Äôavoir un orgasme tr√®s fort pour humilier / faire rire quelqu‚Äôun ?", next:"q51" },
  
  { id:"q51", type:"yesno", text:"As-tu d√©j√† utilis√© un l√©gume / fruit pour te p√©n√©trer ?", onYes:"q51a", onNo:"q51b" },
  { id:"q51a", type:"choice", text:"Lequel ?", options:["Concombre", "Courgette", "Banane", "Carotte", "Autre truc chelou"], next:"q51b" },
  { id:"q51b", type:"yesno", text:"As-tu d√©j√† utilis√© un objet du quotidien (t√©l√©phone, brosse √† dents, manette de jeu, bouteille d‚Äôeau‚Ä¶) pour te masturber ou te p√©n√©trer ?", onYes:"q51c", onNo:"q52" },
  { id:"q51c", type:"choice", text:"Lequel √©tait le plus inattendu ?", options:["T√©l√©phone vibreur", "Brosse √† dents √©lectrique", "Manette / joystick", "Bouteille / canette", "Autre objet random"], next:"q52" },
  
  { id:"q52", type:"yesno", text:"As-tu d√©j√† mis ton p√©nis / tes testicules dans un pot de yaourt / cr√®me glac√©e pour le fun ?", next:"q53" },
  
  { id:"q53", type:"yesno", text:"As-tu d√©j√† bu ton propre sperme (m√™me une goutte) ?", onYes:"q53a", onNo:"q54" },
  { id:"q53a", type:"choice", text:"C‚Äô√©tait volontaire ?", options:["Oui, expr√®s", "Non, accident / d√©fi perdu", "Juste go√ªt√© du bout de la langue"], next:"q54" },
  
  { id:"q54", type:"yesno", text:"As-tu d√©j√† cherch√© du porno avec des th√®mes ill√©gaux juste par curiosit√© (m√™me sans regarder jusqu‚Äôau bout) ?", next:"q55" },
  
  { id:"q55", type:"yesno", text:"As-tu d√©j√† joui sur une image / vid√©o d‚Äôune c√©l√©brit√© que tu d√©testes ?", next:"q56" },
  
  { id:"q56", type:"yesno", text:"Connais-tu personnellement quelqu‚Äôun qui a fait un revenge porn (ou tu l‚Äôas fait) ?", next:"q57" },
  
    { id:"q57", type:"yesno", 
    text:"As-tu d√©j√† eu un fantasme o√π tu es forc√©¬∑e / tu forces quelqu‚Äôun (m√™me en imagination pure) ?", 
    next:"q58" 
  },

  { id:"q58", type:"yesno", 
    text:"As-tu d√©j√† bu seul chez toi entre 2 h et 5 h du matin ?", 
    next:"q59" 
  },

  { id:"q59", type:"yesno", 
    text:"T‚Äôes-tu d√©j√† r√©veill√© sans aucun souvenir de la veille, mais avec des preuves photo/vid√©o sur ton t√©l√©phone ?", 
    next:"q60" 
  },

  { id:"q60", type:"yesno", 
    text:"As-tu d√©j√† bu plus de 10 verres en une soir√©e au moins 5 fois dans ta vie ?", 
    next:"q61" 
  },

  { id:"q61", type:"yesno", 
    text:"As-tu d√©j√† fait un before (pr√©-soir√©e) seul avant de sortir ?", 
    next:"q62" 
  },

  { id:"q62", type:"yesno", 
    text:"Consid√®res-tu que 4 pintes c‚Äôest ¬´ juste pour commencer la soir√©e ¬ª ?", 
    next:"q63" 
  },

  { id:"q63", type:"yesno", 
    text:"As-tu d√©j√† vomi √† cause de l'alcool ?", 
    onYes:"q63a", onNo:"q64" 
  },

  { id:"q63a", type:"yesno",   // ‚Üê chang√© en yesno pour fluidit√©, puis branchement choice si besoin
    text:"As-tu d√©j√† vomi dans un lieu public (rue, bar, m√©tro, parc...) ?", 
    next:"q63b" 
  },

  { id:"q63b", type:"choice", 
    text:"As-tu d√©j√† vomi **sur quelqu‚Äôun** d‚Äôautre (ami, inconnu, partenaire) ?", 
    options:["Oui, volontairement", "Oui, par accident", "Non, jamais sur quelqu‚Äôun"], 
    next:"q64" 
  },

  { id:"q64", type:"yesno", 
    text:"T‚Äôes-tu d√©j√† disput√© violemment avec quelqu‚Äôun alors que vous √©tiez tous les deux bourr√©s ?", 
    next:"q65" 
  },

  { id:"q65", type:"yesno", 
    text:"As-tu d√©j√† pleur√© en public √† cause de l‚Äôalcool (crise de larmes en soir√©e, confession alcoolis√©e‚Ä¶)", 
    next:"q66" 
  },

  { id:"q66", type:"yesno", 
    text:"As-tu d√©j√† dragu√© / embrass√© quelqu‚Äôun que tu trouvais vraiment moche une fois d√©gris√© ?", 
    next:"q67" 
  },

  { id:"q67", type:"yesno", 
    text:"As-tu d√©j√† envoy√© un message tr√®s g√™nant / tr√®s lourd √† ton ex / crush / patron pendant une cuite ?", 
    next:"q68" 
  },

  { id:"q68", type:"yesno", 
    text:"As-tu d√©j√† conduit (voiture, scooter, v√©lo‚Ä¶) apr√®s avoir clairement trop bu ?", 
    next:"q69" 
  },

  { id:"q69", type:"yesno", 
    text:"As-tu d√©j√† bu au point de tomber dans les pommes / black-out total ?", 
    next:"q70" 
  },

  { id:"q70", type:"yesno", 
    text:"T‚Äôes-tu d√©j√† r√©veill√© chez une personne inconnue sans savoir comment tu y es arriv√© ?", 
    next:"q71" 
  },

  { id:"q71", type:"yesno", 
    text:"As-tu d√©j√† m√©lang√© alcool + m√©dicaments / drogues dures au point d‚Äôavoir vraiment eu peur pour ta sant√© ?", 
    next:"q72" 
  },

  { id:"q72", type:"yesno", 
    text:"As-tu d√©j√† bu directement √† la bouteille en mode ¬´ je m‚Äôen fous ¬ª devant des gens qui te jugeaient ?", 
    next:"q73" 
  },

  { id:"q73", type:"yesno", 
    text:"As-tu d√©j√† bu de l‚Äôalcool dans un cimeti√®re, une √©glise ou un lieu de recueillement ?", 
    next:"q74" 
  },

  { id:"q74", type:"yesno", 
    text:"T‚Äôes-tu d√©j√† saoul√© dans les transports en commun (train, avion, bus longue distance‚Ä¶)", 
    next:"q75" 
  },

  { id:"q75", type:"yesno", 
    text:"As-tu d√©j√† bu de l‚Äôalcool fort au petit-d√©jeuner (ou au moins essay√©) ?", 
    next:"q76" 
  },

  { id:"q76", type:"yesno", 
    text:"L‚Äôalcool te donne-t-il souvent envie de baiser (plus que d‚Äôhabitude) ?", 
    onYes:"q76a", onNo:"q77" 
  },
  { id:"q76a", type:"choice", 
    text:"√Ä quel point ?", 
    options:["Un peu plus que d‚Äôhabitude", "Beaucoup plus", "Je deviens obs√©d√©¬∑e", "Je fais vraiment n‚Äôimporte quoi une fois bourr√©¬∑e"], 
    next:"q77" 
  },

  { id:"q77", type:"yesno", 
    text:"L‚Äôalcool t‚Äôa-t-il d√©j√† fait p√©cho / embrasser / draguer une personne qui te d√©pla√Æt compl√®tement une fois d√©gris√©¬∑e ?", 
    onYes:"q77a", onNo:"q78" 
  },
  { id:"q77a", type:"choice", 
    text:"Si oui, jusqu‚Äôo√π c‚Äôest all√© ?", 
    options:["Juste une galoche / un bisou", "Pr√©liminaires / pelotage lourd", "Sexe complet / p√©n√©tration", "J‚Äôai regrett√© au r√©veil mais j‚Äôai continu√© quand m√™me"], 
    next:"q78" 
  },

  { id:"q78", type:"yesno", 
    text:"As-tu d√©j√† eu un plan cul compl√®tement improvis√© et anonyme sous l‚Äôeffet de l‚Äôalcool ?", 
    next:"q79" 
  },

  { id:"q79", type:"yesno", 
    text:"T‚Äôes-tu d√©j√† retrouv√©¬∑e √† chanter / danser comme un¬∑e fou¬∑folle sur du mauvais son en public √† cause de l‚Äôalcool ?", 
    next:"q80" 
  },

  { id:"q80", type:"yesno", 
    text:"As-tu d√©j√† perdu un objet pr√©cieux (t√©l√©phone, portefeuille, cl√©) pendant une cuite ?", 
    next:"q81" 
  },

  { id:"q81", type:"yesno", 
    text:"As-tu d√©j√† piss√© sur toi ou sur quelqu‚Äôun d‚Äôautre pendant une cuite ?", 
    next:"q82" 
  },

  { id:"q82", type:"yesno", 
    text:"T‚Äôes-tu d√©j√† masturb√© bourr√© en mode ¬´ je regrette tout ¬ª ?", 
    next:"q83" 
  },

  { id:"q83", type:"yesno", 
    text:"As-tu d√©j√† essay√© d‚Äôarr√™ter l‚Äôalcool pendant plus d‚Äôun mois et √©chou√© ?", 
    next:null 
  },
];

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// Cat√©gories + poids
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const CATEGORIES = {
  "basique":{ name: "Exp√©riences sexuelles classiques", weight: 1   },
  
  "famille_tabou":        { name: "Famille / Inceste / Tabou",        weight: 6   },
  
  "animaux":              { name: "Bestialit√© / Animaux",             weight: 10  },
  
  "crimes_noncons":       { name: "Crimes / Non-consentement",        weight: 8   },

  "bdsm_extreme":         { name: "BDSM / Pratiques extr√™mes",        weight: 3   },
 
  "public_exhibition":    { name: "Public / Exhibition / Humiliation",weight: 2   },
 
  "objets_mastur":        { name: "Objets insolites / Masturbation",  weight: 2   },
  
  "porno_internet":       { name: "Porno / Internet / R√®gle 34",      weight: 1.5 },
 
  "autres":               { name: "Divers / Psychologie / Autres",    weight: 1   },
  
  "alcool": { name: "Alcool / Cuites / D√©pendance", weight: 2.5 }
};

const CATEGORY_MAP = {
  "q1":"basique", 
  "q2":"public_exhibition", 
  "q3":"objets_mastur", 
  "q4":"basique",
  "q5":"basique", 
  "q6":"crimes_noncons", 
  "q7":"crimes_noncons", 
  "q8":"basique",
  "q9":"famille_tabou", 
  "q10":"crimes_noncons", 
  "q11":"famille_tabou", 
  "q12":"autres",
  "q13":"autres", 
  "q14":"basique", 
  "q15":"public_exhibition", 
  "q16":"public_exhibition",
  "q17":"basique", 
  "q18":"bdsm_extreme", 
  "q19":"bdsm_extreme", 
  "q20":"public_exhibition",
  "q21":"famille_tabou", 
  "q22":"basique", 
  "q23":"public_exhibition", 
  "q24":"objets_mastur",
  "q25":"basique", 
  "q26":"basique", 
  "q27":"basique", 
  "q28":"animaux", 
  "q29":"animaux",
  "q30":"public_exhibition", 
  "q31":"autres", 
  "q32":"autres", 
  "q33":"porno_internet",
  "q34":"porno_internet", 
  "q35":"objets_mastur", 
  "q36":"objets_mastur", 
  "q37":"bdsm_extreme",
  "q38":"basique", 
  "q39":"objets_mastur", 
  "q40":"famille_tabou", 
  "q41":"famille_tabou",
  "q42":"famille_tabou", 
  "q43":"animaux", 
  "q46":"bdsm_extreme", 
  "q47":"bdsm_extreme",
  "q48":"public_exhibition", 
  "q49":"public_exhibition", 
  "q50":"public_exhibition",
  "q51":"objets_mastur", 
  "q52":"objets_mastur", 
  "q53":"objets_mastur", 
  "q54":"porno_internet",
  "q55":"porno_internet", 
  "q56":"autres", 
  "q57":"crimes_noncons",
  "q58":"alcool", 
  "q59":"alcool", 
  "q60":"alcool", 
  "q61":"alcool", 
  "q62":"alcool",
  "q63":"alcool", 
  "q64":"alcool", 
  "q65":"alcool", 
  "q66":"alcool", 
  "q67":"alcool",
  "q68":"alcool", 
  "q69":"alcool", 
  "q70":"alcool",
  "q71":"alcool",
  "q72":"alcool",
  "q73":"alcool",
  "q74":"alcool",
  "q75":"alcool", 
  "q76":"alcool", 
  "q77":"alcool",
  "q78":"alcool", 
  "q79":"alcool",
  "q80":"alcool",
  "q81":"alcool",
  "q82":"alcool",
  "q83":"alcool"
  
};

// Pr√©-assignation des cat√©gories aux questions yes/no
Object.keys(CATEGORY_MAP).forEach(id => {
  const q = QUESTIONS.find(qq => qq.id === id);
  if (q && q.type === "yesno") {
    q.category = CATEGORY_MAP[id];
  }
});

const totalYesNoQuestions = QUESTIONS.filter(q => q.type === "yesno").length;

let currentId = null;
let history = [];
let answers = {};
let yesCount = 0;
let extraPenaltyPoints = 0;

const $ = id => document.getElementById(id);
const screenIntro  = $("screenIntro");
const screenQuiz   = $("screenQuiz");
const screenResult = $("screenResult");
const qText    = $("qText");
const counter  = $("counter");
const bar      = $("bar");
const yesnoBlock  = $("yesnoBlock");
const choiceBlock = $("choiceBlock");

function show(el) {
  [screenIntro, screenQuiz, screenResult].forEach(s => s.classList.add("hidden"));
  el.classList.remove("hidden");
}

function resetAll() {
  currentId = QUESTIONS[0]?.id ?? null;
  history = [];
  answers = {};
  yesCount = 0;
  extraPenaltyPoints = 0;
  if (currentId) render();
}

function progressYesNoDone() {
  return QUESTIONS.filter(q => q.type === "yesno" && answers[q.id]).length;
}

function render() {
  const q = QUESTIONS.find(qq => qq.id === currentId);
  if (!q) return;

  qText.textContent = q.text;

  const done = progressYesNoDone();
  counter.textContent = `Progression : ${done} / ${totalYesNoQuestions}`;
  bar.style.width = totalYesNoQuestions ? (done / totalYesNoQuestions * 100) + "%" : "0%";

  yesnoBlock.classList.toggle("hidden", q.type !== "yesno");
  choiceBlock.classList.toggle("hidden", q.type !== "choice");

  if (q.type === "choice") {
    choiceBlock.innerHTML = "";
    q.options.forEach(opt => {
      const b = document.createElement("button");
      b.className = "btn choice";
      b.textContent = opt;
      b.onclick = () => answerChoice(opt);
      choiceBlock.appendChild(b);
    });
  }
}

function go(nextId) {
  if (!nextId) return showResult();
  history.push(currentId);
  currentId = nextId;
  render();
}

function answerYesNo(isYes) {
  const q = QUESTIONS.find(qq => qq.id === currentId);
  if (!q || q.type !== "yesno") return;

  answers[q.id] = { type:"yesno", value: isYes ? "Oui" : "Non" };
  if (isYes) {
    yesCount++;
    // P√©nalit√©s yes/no tr√®s lourdes
    if (["q6","q10","q11","q28","q29","q43"].includes(q.id)) extraPenaltyPoints += 12;
    if (["q9","q40","q41","q42"].includes(q.id)) extraPenaltyPoints += 8;
  }

  const nextId = isYes ? (q.onYes ?? q.next) : (q.onNo ?? q.next);
  go(nextId);
}

function answerChoice(value) {
  const q = QUESTIONS.find(qq => qq.id === currentId);
  if (!q || q.type !== "choice") return;

  answers[q.id] = { type:"choice", value };

  // P√©nalit√©s selon le choix
  extraPenaltyPoints += getChoicePenalty(q.id, value);

  if (q.nextMap && q.nextMap[value] !== undefined) {
    go(q.nextMap[value]);
  } else {
    go(q.next);
  }
}

function getChoicePenalty(qid, val) {
  const penalties = {
    "10+":15, "5‚Äì10":9, "20+":20, "R√©guli√®rement":8, "C'est mon genre principal":12,
    "Enfant":25, "membre de la famille":18, "cheval":30, "animaux de ferme":25,
    "Oui et j‚Äôai continu√©":12, "Tr√®s port√© / odeur forte":10, "Sale / port√©":7,
    "Oui, expr√®s":8, "Autre truc chelou":6, "Autre objet random":5,
        
    "Sexe complet / p√©n√©tration": 10,
    "Je fais vraiment n‚Äôimporte quoi une fois bourr√©¬∑e": 9,
    "Je deviens obs√©d√©¬∑e": 7,
    "Oui, volontairement": 8,
    "Oui, par accident": 4
    
  };
  return penalties[val] || 3; // valeur par d√©faut
}

function back() {
  if (!history.length) return;
  const prevId = history.pop();
  const prevAns = answers[prevId];

  if (prevAns) {
    if (prevAns.type === "yesno" && prevAns.value === "Oui") yesCount--;
    // On ne retire pas les extra points (approximation acceptable)
    delete answers[prevId];
  }
  currentId = prevId;
  render();
}

function computeCategoryScores() {
  const catStats = {};

  Object.keys(CATEGORIES).forEach(key => {
    catStats[key] = { yes:0, total:0, name:CATEGORIES[key].name, weight:CATEGORIES[key].weight };
  });

  QUESTIONS.forEach(q => {
    if (q.type !== "yesno" || !q.category) return;
    const cat = catStats[q.category];
    cat.total++;
    if (answers[q.id]?.value === "Oui") cat.yes++;
  });

  return Object.values(catStats).filter(c => c.total > 0);
}

function computeGlobalPurity() {
  const cats = computeCategoryScores();

  let totalWeightedYes = extraPenaltyPoints;
  let totalWeightedMax = extraPenaltyPoints;

  cats.forEach(cat => {
    const yesRatio = cat.yes / cat.total;
    totalWeightedYes += yesRatio * cat.total * cat.weight;
    totalWeightedMax += cat.total * cat.weight;
  });

  if (totalWeightedMax === 0) return 100;
  const purity = Math.round(100 - (totalWeightedYes / totalWeightedMax * 100));
  return Math.max(0, purity);
}

function getGlobalComment(p) {
  if (p >= 90) return "üïäÔ∏è Pur comme la neige √©ternelle";
  if (p >= 75) return "üòá Presque un saint";
  if (p >= 55) return "üòè Zone grise assum√©e";
  if (p >= 30) return "üòà Chaos organis√©";
  return "üî• Bienvenue dans les abysses";
}

function showResult() {
  show(screenResult);

  const purity = computeGlobalPurity();
  const cats = computeCategoryScores();

  $("resultMain").innerHTML = `Puret√© globale : <b>${purity}%</b><br><small>${getGlobalComment(purity)}</small>`;

  let html = `<p>Oui aux questions principales : ${yesCount} / ${totalYesNoQuestions}<br>Points de p√©nalit√© (secondaires + graves) : ${extraPenaltyPoints}</p>`;
  html += `<table><tr><th>Cat√©gorie</th><th>Puret√©</th><th>Oui</th></tr>`;

  cats.forEach(cat => {
    const catPurity = Math.round( (cat.total - cat.yes) / cat.total * 100 );
    let color = catPurity >= 80 ? "#88ff88" : catPurity >= 50 ? "#ffdd88" : "#ff8888";
    html += `<tr><td>${cat.name}</td><td style="color:${color}">${catPurity}%</td><td>${cat.yes}/${cat.total}</td></tr>`;
  });

  html += `</table>`;
  $("resultText").innerHTML = html;

  window.__resultText = `Puret√©: ${purity}% - ${getGlobalComment(purity)}`;
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// √âv√©nements
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
$("startBtn").onclick   = () => { show(screenQuiz); resetAll(); };
$("btnYes").onclick     = () => answerYesNo(true);
$("btnNo").onclick      = () => answerYesNo(false);
$("btnBack").onclick    = back;
$("btnRestart").onclick = resetAll;
$("btnReplay").onclick  = () => { show(screenQuiz); resetAll(); };

$("btnCopy").onclick = async () => {
  try {
    await navigator.clipboard.writeText(window.__resultText || "Pas de r√©sultat");
    $("btnCopy").textContent = "Copi√© ‚úì";
    setTimeout(() => $("btnCopy").textContent = "Copier r√©sultat", 1500);
  } catch(e) {
    $("btnCopy").textContent = "Erreur...";
  }
};
</script>
</body>
</html>